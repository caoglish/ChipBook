"use strict";(self["webpackChunkchipbook"]=self["webpackChunkchipbook"]||[]).push([[264],{1264:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var r=a(6768),i=a(4232),n=a(554),s=a(6329);const c=e=>((0,r.Qi)("data-v-9739d98a"),e=e(),(0,r.jt)(),e),d=c((()=>(0,r.Lk)("h2",null,"游戏历史记录",-1)));function o(e,t,a,c,o,m){return(0,r.uX)(),(0,r.CE)("div",null,[d,(0,r.bF)(s.Py,{headers:e.historyHeaders,items:e.games,class:"mt-4"},{"item.actions":(0,r.k6)((({item:t})=>[(0,r.bF)(n.D,{color:"primary",onClick:a=>e.viewGame(t.id)},{default:(0,r.k6)((()=>[(0,r.eW)("查看")])),_:2},1032,["onClick"])])),"item.created_at":(0,r.k6)((({item:t})=>[(0,r.Lk)("span",null,(0,i.v_)(e.formatDate(t.created_at)),1)])),_:1},8,["headers","items"])])}a(4114);var m=a(7617),l=a(4889);const h=l.A;var u=(0,r.pM)({name:"History",data(){return{games:[],historyHeaders:[{title:"游戏ID",key:"id"},{title:"创建时间",key:"created_at"},{title:"玩家数量",key:"player_count"},{title:"每手筹码",key:"chips_per_hand"},{title:"每手金额",key:"amount_per_hand"},{title:"操作",value:"actions",sortable:!1}]}},methods:{async fetchAllGames(){try{const e=(0,m.rJ)(h,"games"),t=await(0,m.GG)(e),a=t.docs.map((async e=>{const t=e.data(),a=e.id,r=(0,m.rJ)(h,`games/${a}/players`),i=await(0,m.GG)(r),n=i.size;return{id:a,created_at:new Date(t.created_at),player_count:n,chips_per_hand:t.chips_per_hand,amount_per_hand:t.amount_per_hand}})),r=await Promise.all(a);this.games=r.sort(((e,t)=>t.created_at-e.created_at))}catch(e){console.error("Error fetching all games:",e),alert("无法加载游戏历史，请重试。")}},formatDate(e){return e?new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(e):""},viewGame(e){this.$router.push({name:"GameManagement",params:{gameId:e}})}},created(){this.fetchAllGames()}}),_=a(1241);const p=(0,_.A)(u,[["render",o],["__scopeId","data-v-9739d98a"]]);var k=p}}]);